{"version":3,"sources":["../../src/event/index.js"],"names":["getEventStorage","eventStorage","evtConfig","get","StorageType","storage","Error","configFailed","t"],"mappings":";;;;;QAOgBA,e,GAAAA,e;;AAPhB;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAIC,qBAAJ;;AAEO,SAASD,eAAT,GAA2B;AAChC,MAAME,YAAY,iBAAOC,GAAP,CAAW,OAAX,CAAlB;;AAEA,MAAIF,YAAJ,EAAkB;AAChB,WAAOA,YAAP;AACD;;AAED,MAAIG,cAAc,OAAOF,UAAUG,OAAjB,KAA6B,UAA7B,GAA0CH,UAAUG,OAApD,GAA8D,cAAhF;;AAEA,MAAIA,UAAUH,UAAUG,OAAV,IAAqB,cAArB,GAAsC,oCAAtC,GAAiED,cAAcA,aAAd,GAA8B,IAA7G;AACA,MAAI,CAACC,OAAL,EACE,MAAMC,MACJ,cAAIC,YADA,EAEJ,eAAKC,CAAL,CAAO,iCAAP,CAFI,CAAN;;AAKFP,iBAAeI,OAAf;;AAEA,SAAOA,OAAP;AACD","file":"index.js","sourcesContent":["import DomainEventStorage from './domain_event_storage';\r\nimport config from '../config';\r\nimport err from '../err';\r\nimport i18n from '../i18n';\r\n\r\nlet eventStorage;\r\n\r\nexport function getEventStorage() {\r\n  const evtConfig = config.get('event');\r\n\r\n  if (eventStorage) {\r\n    return eventStorage;\r\n  }\r\n\r\n  let StorageType = typeof evtConfig.storage === 'function' ? evtConfig.storage : 'domain_event';\r\n\r\n  let storage = evtConfig.storage == 'domain_event' ? new DomainEventStorage() : StorageType ? StorageType() : null;\r\n  if (!storage)\r\n    throw Error(\r\n      err.configFailed,\r\n      i18n.t('事件仓库未正确配置，可以在config/event.js中指定')\r\n    );\r\n\r\n  eventStorage = storage;\r\n\r\n  return storage;\r\n}\r\n"]}