{"version":3,"sources":["../../src/bus/direct_bus.js"],"names":["type","dispatcher","messageQueue","messages","msg","push","clear","forEach","dispatch","name","data","commit","rollback"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;;;;;;;AAGE,kBAAYA,IAAZ,EAAkBC,UAAlB,EAA6B;AAAA;;AAC3B,SAAKC,YAAL,GAAoB,EAApB;AACA,SAAKF,IAAL,GAAYA,IAAZ;AACA,SAAKC,UAAL,GAAkBA,UAAlB;AACD;;;;8BAEmB;AAAA,wCAATE,QAAS;AAATA,gBAAS;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAClB,wDAAeA,QAAf,4GAAwB;AAAA,cAAhBC,GAAgB;;AACtB,eAAKF,YAAL,CAAkBG,IAAlB,CAAuBD,GAAvB;AACD;AAHiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAInB;;;4BAEM;AACL,WAAKF,YAAL,CAAkBI,KAAlB;AACD;;;6BAEO;AAAA;;AACN,WAAKJ,YAAL,CAAkBK,OAAlB,CAA0B,eAAK;AAC7B,cAAKN,UAAL,CAAgBO,QAAhB,CAAyB,EAACR,UAAD,EAAOS,MAAKL,IAAIK,IAAhB,EAAsBC,MAAKN,IAAIM,IAA/B,EAAzB;AACD,OAFD;AAGA,2BAAWC,MAAX;AACA,WAAKT,YAAL,CAAkBI,KAAlB;AACD;;;+BAES;AACR,2BAAWM,QAAX;AACD","file":"direct_bus.js","sourcesContent":["import repository from '../repository';\r\n\r\nexport default class {\r\n  constructor(type, dispatcher){\r\n    this.messageQueue = [];\r\n    this.type = type;\r\n    this.dispatcher = dispatcher;\r\n  }\r\n\r\n  publish(...messages){\r\n    for(let msg of messages){\r\n      this.messageQueue.push(msg);\r\n    }\r\n  }\r\n\r\n  clear(){\r\n    this.messageQueue.clear();\r\n  }\r\n\r\n  commit(){\r\n    this.messageQueue.forEach(msg=>{\r\n      this.dispatcher.dispatch({type, name:msg.name, data:msg.data});\r\n    });\r\n    repository.commit();\r\n    this.messageQueue.clear();\r\n  }\r\n\r\n  rollback(){\r\n    repository.rollback();\r\n  }\r\n}\r\n"]}